name: Pull and Push Third-Party Image

on:
  workflow_dispatch:
    inputs:
      my_var:
        description: 'Value for MY_VAR'
        required: true
        default: 'Hello, World!'
      another_var:
        description: 'Value for ANOTHER_VAR'
        required: true
        default: '42'
      MY_DOCKER_PASSWORD:
        description: 'Value for ANOTHER_VAR'
        required: true
        default: '4246546514'
        

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Set and process environment variables
      run: |
        MY_VAR="${{ inputs.my_var }}"
        ANOTHER_VAR="${{ inputs.another_var }}"
        NCOINT_APARMAR_SANDBOX_DOCKER_PASSWORD="${{ inputs.MY_DOCKER_PASSWORD }}

        # Check if MY_VAR is lowercase and convert to uppercase
        if [[ "$MY_VAR" =~ ^[a-z]+$ ]]; then
          MY_VAR=$(echo "$MY_VAR" | tr '[:lower:]' '[:upper:]')
        fi

        # Check if ANOTHER_VAR is lowercase and convert to uppercase
        if [[ "$ANOTHER_VAR" =~ ^[a-z]+$ ]]; then
          ANOTHER_VAR=$(echo "$ANOTHER_VAR" | tr '[:lower:]' '[:upper:]')
        fi

        echo "MY_VAR=$MY_VAR" >> $GITHUB_ENV
        echo "ANOTHER_VAR=$ANOTHER_VAR" >> $GITHUB_ENV

    - name: Echo environment variables
      run: |
        echo "MY_VAR: $MY_VAR"
        echo "ANOTHER_VAR: $ANOTHER_VAR"

    - name: Get DOCKER_PASSWORD environment variable
      run: |
        for VAR in $(env); do
          if [[ $VAR == *DOCKER_PASSWORD=* ]]; then
            DOCKER_PASSWORD=${VAR#*=}
            echo "Found DOCKER_PASSWORD: $DOCKER_PASSWORD"
            break
          fi
        done

